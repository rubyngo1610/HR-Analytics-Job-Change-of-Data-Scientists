import pandas as pd

train_data = pd.read_csv('aug_train.csv')
test_data = pd.read_csv('aug_test.csv')

train_data.head()
train_data.describe(include='all')


#Ruby

#import packages
import pandas as pd
import numpy as np
import pandasql as sql

#read the train data
train_data = pd.read_csv('aug_train.csv')

train_data.head(10)

train_data.describe(include='all')

#count the NAs in the train data
train_data.isnull().sum()

#Drop those who are missing information about their experience
train_data_1 = """
    SELECT *
    FROM train_data
    WHERE experience is not null;
    """
train_data_1 = train_data_1.lower()    
#Execute your SQL command against the pandas frame
sql.sqldf(train_data_1, locals())

#look specifically at the enrolled_university, education_level, and the major_discipline data
q = """
    select enrolled_university, education_level, major_discipline
    from train_data
    WHERE major_discipline is null;
    """
    
#Execute your SQL command against the pandas frame
sql.sqldf(q.lower(), locals()).head(15)
#All of those who don't have a major_discipline were undergrad students or did not attend college

for i in train_data:
    print(train_data[i].unique())
    
#handle the NAs
train_data["gender"] = train_data["gender"].fillna("Not Reported")
train_data["major_discipline"] = train_data[train_data.enrolled_university == "no_enrollment"]["major_discipline"].fillna("No Major")
train_data["major_discipline"] = train_data["major_discipline"].fillna("Not Reported")
train_data["company_size"] = train_data["company_size"].fillna("Not Reported")
train_data["company_type"] = train_data["company_type"].fillna("Not Reported")
train_data["last_new_job"] = train_data["last_new_job"].fillna("Not Reported")

train_data["company_size"] = train_data["company_size"].replace("10/49","10-49")

#train_data['experience']
for i in range(len(train_data['experience'])):
    if train_data['experience'][i] in ["1","2","3","4","5"]:
        train_data['experience'][i] = "1-5"
    elif train_data['experience'][i] in ["6","7","8","9","10"]:
        train_data['experience'][i] = "6-10"
    elif train_data['experience'][i] in ["11","12","13","14","15"]:
        train_data['experience'][i] = "11-15"
    elif train_data['experience'][i] in ["16","17","18","19","20"]:
        train_data['experience'][i] = "16-20"
